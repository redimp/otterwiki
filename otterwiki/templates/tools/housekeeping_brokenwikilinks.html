<form hx-post="{{ url_for("housekeeping") }}" hx-target="this" hx-indicator="#brokenwikilinks_indicator">
<input type="hidden" name="task" value="brokenwikilinks">
{% if stats and pages %}
<div class="mb-20">
<p> To keep your wiki clean, please review the following {{pages|length}} page{{pages|length|pluralize("s")}} with broken WikiLinks.
{{stats.pages}} page{{stats.pages|pluralize("s")}} were checked in {{stats.duration}}.
</p>
<input class="btn btn-primary" type="submit" name="refresh" value="Refresh"/>
<span id="brokenwikilinks_indicator" class="htmx-indicator"><i class="fas fa-spinner fa-spin"></i></span>
</div>
<div class="table-responsive table-striped">
<table class="table compact">
    <thead>
        <tr>
            <td style="width:1px;"><strong>Page</strong></td>
            <td style="width:1px;text-align:right;"><strong>Broken Links</strong></td>
        </tr>
    </thead>
    <tbody>
{% for pagename, broken_links in pages.items() %}
        <tr>
            <td>
                <a href="{{ url_for('view', path=pagename) }}" target="_blank">{{pagename}}</a>&nbsp;
            </td>
            <td style="width:1px;text-align:right;padding-right:.5rem;">
                {{broken_links|length}}
            </td>
        </tr>
{% endfor %}
    </tbody>
</table>

</div>
{% else %}
{% if stats %}
<p>No broken WikiLinks found. Checked {{stats.pages}} page{{stats.pages|pluralize("s")}} in {{stats.duration}}.</p>
{% else %}
<p>To find pages with broken WikiLinks, start an analysis.</p>
{% endif %}
<div>
    <input class="btn btn-primary" type="submit" name="refresh" value="Analyse pages"/>
    <span id="brokenwikilinks_indicator" class="htmx-indicator"><i class="fas fa-spinner fa-spin"></i></span>
</div>
{% endif %}
</form>
