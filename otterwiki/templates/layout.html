{#- vim: set et ts=8 sts=4 sw=4 ai: -#}
<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Meta tags -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
  <meta name="viewport" content="width=device-width" />

  <!-- Favicon and title -->
  <link rel="icon" href="{{ url_for("static", filename="img/otter-favicon2.png") }}">
{% block title %}
<title>{%if title%}{{title}} &ndash; {%endif%}{%if config.SITE_NAME %}{{config.SITE_NAME}}{%else%}An Otter Wiki{%endif%}</title>
{% endblock %}
    <link href="{{ url_for("static", filename="css/halfmoon.min.css") | debug_unixtime }}" rel="stylesheet" media="screen" />
    <!-- Otterwiki CSS -->
    <link href="{{ url_for("static", filename="css/otterwiki.css") | debug_unixtime }}" rel="stylesheet" media="screen" />
    <!-- Otterwiki Print -->
    <link href="{{ url_for("static", filename="css/print.css") | debug_unixtime }}" rel="stylesheet" media="print" />
    <!-- Font awesome -->
    <link rel="stylesheet" href="{{ url_for("static", filename="css/fontawesome-all.min.css") | debug_unixtime }}">
    <!-- pygments  -->
    <link href="{{ url_for("static", filename="css/pygments.css") | debug_unixtime }}" rel="stylesheet" />
    <!-- Roboto font (Used when Apple system fonts are not available) -->
    <link href="{{ url_for("static", filename="css/roboto.css") | debug_unixtime }}" rel="stylesheet"/>
    <!-- Documentation styles -->
{%- block head %}
{% endblock -%}
{%- if request.cookies.get('halfmoon_preferredMode') == "dark-mode" %}
{#- Dark Mode Optimization -#}
    <!-- Chrome, Firefox OS and Opera mobile address bar theming -->
    <meta name="theme-color" content="#000000">
    <!-- Windows Phone mobile address bar theming -->
    <meta name="msapplication-navbutton-color" content="#000000">
    <!-- iOS Safari mobile address bar theming -->
    <meta name="apple-mobile-web-app-status-bar-style" content="#000000">
{% endif -%}
</head>
<body class="{% if request.cookies.get('halfmoon_preferredMode') == "dark-mode" %}dark-mode {%endif%}with-custom-webkit-scrollbars with-custom-css-scrollbars">
{%- block bodytop %}
{% endblock -%}
    <!-- Page wrapper start -->
    <div id="page-wrapper" class="page-wrapper {% block page_wrapper_config -%}with-navbar with-sidebar{%-endblock%}" {%-if request.cookies.get('halfmoon_sidebar') == "hidden" -%}data-sidebar-hidden="hidden"{%-endif-%}>

        <!-- Sticky alerts -->
        <div class="sticky-alerts"></div>

{% block navbarmain %}
        <!-- Navbar start -->
        <nav class="navbar">
            <div class="navbar-content">
                <button id="toggle-sidebar-btn" class="btn btn-action" type="button" onclick="halfmoon.toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            <a href="{{ url_for("index") }}" class="navbar-brand ml-10 ml-sm-20">
{% if config.SITE_LOGO %}
                <img src="{{ config.SITE_LOGO }}" alt=""/><br/>
{% else %}
                <img src="{{ url_for("static", filename="img/otterhead.png") }}" alt="">
{% endif %}
                <span class="d-none d-sm-flex">{{ config.SITE_NAME }}</span>
            </a>
            <div class="navbar-content ml-auto">
{% block navbarsearch %}
                <form action="{{ url_for("search") }}" method="post">
                <input name="query" type="text" class="form-control mr-5" placeholder="Search">
                </form>
{% endblock %}
                <div class="dropdown">
                  <button class="btn btn-action mr-5" data-toggle="dropdown" type="button" id="navbar-dropdown-toggle-btn-1">
                    <i class="fas fa-ellipsis-v"></i>
                  </button>
                  <div class="dropdown-menu dropdown-menu-right w-200" aria-labelledby="navbar-dropdown-toggle-btn-1"> <!-- w-200 = width: 20rem (200px) -->

{% block navbardropdown %}
{% if has_permission('READ') %}
                    <div class="dropdown-divider mt-5 mb-5"></div>
{% endif %}
                    <a href="#" class="dropdown-item-with-icon" onclick="halfmoon.toggleDarkMode()">
                        <span class="dropdown-icon">
                            <i class="far fa-moon"></i>
                        </span>
                        Toggle dark mode
                    </a>
{#-
                    <a href="{{ url_for("about") }}" class="dropdown-item-with-icon">
                        <span class="dropdown-icon">
                            <i class="fas fa-info-circle"></i>
                        </span>
                        About
                    </a>
-#}
{% if not current_user.is_authenticated %}
                    <a href="{{ url_for("login") }} " class="dropdown-item-with-icon">
                        <span class="dropdown-icon">
                            <i class="fas fa-sign-in-alt"></i>
                        </span>
                        Login
                    </a>
{% else %}
                    <a href="{{ url_for("settings") }}" class="dropdown-item-with-icon">
                        <span class="dropdown-icon">
                            <i class="fas fa-cogs"></i>
                        </span>
                        Settings
                    </a>
                    <a href="{{ url_for("logout") }}"  class="dropdown-item-with-icon">
                        <span class="dropdown-icon">
                            <i class="fas fa-sign-out-alt"></i>
                        </span>
                        Logout
                    </a>
{% endif %}
{% endblock %}
                  </div> <!-- inner dropdown -->
                </div> <!-- dropdown -->
{% block navbar %}
{% endblock %}
            </div>
        </nav>
        <!-- Navbar end -->
{% endblock %}


{% block sidebaroverlay %}
        <!-- Sidebar overlay -->
        <div class="sidebar-overlay" onclick="halfmoon.toggleSidebar()"></div>

        <!-- Sidebar start -->
        <div class="sidebar d-flex flex-column">
            <div class="sidebar-menu w-full flex-grow-1">
                {% block menu %}
                {% endblock %}
            </div>
            <div class="sidebar-menu text-center w-full" >
                <a href=" {{ url_for("about") }}" class="sidebar-link">
                <img class="sidebar-logo" src="{{ url_for("static", filename="img/otter.png") | debug_unixtime }}" alt=""/><br/>
                An Otter Wiki
                </a>
            </div>
        </div>
        <!-- Sidebar end -->
{% endblock %}

{% block content_wrapper %}
        <!-- Content wrapper start -->
        <div class="content-wrapper">

            <div class="container">
                <!-- Simple Layouting and Elements Test -->
                <div class="content">
{% block breadcrumbs %}
{% endblock %}
{% block content %}
{{content|safe}}
{% endblock %}
                </div> <!-- content -->
            </div>
        </div>
        <!-- Content wrapper end -->
{% endblock %}
    </div>
    <!-- Page wrapper end -->
  <!-- Halfmoon JS -->
  <script src="{{ url_for("static", filename="js/halfmoon.js") | debug_unixtime }}"></script>
{% block js %}
{% endblock %}
{#
    Flashes
#}
<script type="text/javascript">
{% with messages = get_flashed_messages(with_categories=true) %}
  {% for category, message in messages %}
    halfmoon.initStickyAlert({
      content: "{{ message | safe}}",
      alertType: "{{category}}",
      fillType: "filled",
      hasDismissButton: true,
{% if category in ["alert-danger"] %}
      timeShown: 60000,
{% elif category in ["alert-secondary"] %}
      timeShown: 120000,
{% endif %}
    });
  {% endfor %}
{% endwith %}
</script>
</body>
</html>
